require 'set'

class RelevantVulnerability # Non ActiveRecord

  def self.users_systems(user)
    all_projects = user.projects

    systems = Set.new
    
    all_projects.each do |project|
      systems.merge(project.systems)
    end
    
    systems.to_a
  end

  def self.affected_systems(vulnerability, user)
    systems = RelevantVulnerability.users_systems(user)
    summary = vulnerability.summary.downcase 
    res = []
    systems.each do |system|
      res.push system if summary.include? system.downcase
    end
    res
  end

  def self.projects_having_system(system, user)
    res = []
    user.projects.each do |project|
      res.push project if project.systems.include? system
    end
    res
  end


end

