require 'rails_helper'

RSpec.describe Vulnerability, type: :model do

  def expect_valid_nvd_url(url) 
    expect(url).to end_with("zip")
    expect(url).to start_with("https://")
    expect(url).to include("nvd.nist.gov")
  end

  describe ".get_nvd_url_for_year" do 
    it "returns valid url" do
      url = Vulnerability.get_nvd_url_for_year(2017)
      expect_valid_nvd_url(url)
    end
  end  

  describe ".get_nvd_update_url" do 
    it "returns valid update url" do
      url = Vulnerability.get_nvd_update_url()
      expect_valid_nvd_url(url)
    end
  end  

end
